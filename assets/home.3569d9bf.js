import{d as e,m as t,n as a,p as n,q as r,s,v as o,x as l,y as i,o as c,c as u,a as m,u as d,z as p,A as h,B as g,t as f,C as _,D as v,g as y,E as w,G as b}from"./vendor.ad827fc2.js";import{a as k}from"./index.edf0dc5a.js";const x=_("data-v-5e88e7e3");v("data-v-5e88e7e3");const $=y("刷新"),C=m("input",{id:"copy_text",style:{opacity:"0",position:"absolute"}},null,-1);w();var N=e({setup(e){const _={user_name:"",display_name:"",user_id:"",score:0,arena_score:0,other:"",user_level:0,achieve:"",achieve_score:0,vip_level:0,slot:0,win_rate:0,game_win_count:0,game_count:0,rank:0,floor:0,hero:""},v=t([_]);v.length=0;const y=a((()=>v.sort(((e,t)=>e.floor-t.floor)))),w=a((()=>-1!=S.value.toLowerCase().indexOf("im")?2:-1!=S.value.toLowerCase().indexOf("omg")?21:1)),N=n(-1),S=n(""),G=n(j());let I=0;r((()=>{!function(){const e="http://127.0.0.1:7733/get-token-by-2009";k.get(e).then((e=>{U.commit("setToken",e.data.token)}))}(),O()}));const E=s();function O(){k.get("http://127.0.0.1:7733/t/get-gamelog",{params:{index:0}}).then((e=>{!function(e){v.length=0,S.value=e[1];const t=P(4,9).concat(P(10,15));for(let s=0;s<t.length;s++){const a=e[t[s]].match(/玩家\[(\d+)\]\[(.*)\]/);if(a){const[e,t,n]=a,r=Number(t)-1;let s=JSON.parse(JSON.stringify(_));s.display_name=n,s.slot=r,v.push(s)}}console.log(v);let a=e[19].match(/本地玩家\[(\d+)\]\[(.*)\]/);if(a){const[e,t,n]=a;I=Number(t)-1}let n=20;if(21==w.value){let t=0;for(;t<10&&n<e.length;){let a=e[n].match(/09game EXSYGetGameCount, (\d+),(\d+)\(number\)/);if(a){const[e,n,r]=a;v[A(n)].game_count=Number(r),t++}n++}}if(2==w.value){const t=P(22,27).concat(P(28,33));for(let a=0;a<t.length;a++){const n=e[t[a]].match(/09game EXSYGetPlayerId, (\d+),(\d+)\(number\)/);if(n){const[e,t,a]=n,r=Number(t);v.filter((e=>e.slot==r))[0].user_id=a}}}if(2==w.value){let t=0;for(;t<10&&n<e.length;){let a=e[n].match(/09game EXSYGetVIPLevel, (\d+),(\d+)\(number\)/);if(a){const[e,n,r]=a;null!=A(n)&&(v[A(n)].vip_level=Number(r),t++)}n++}}for(;-1==N.value&&n<e.length;){let t=e[n].match(/09game EXSYGetGameSource, (\d+)\(number\)/);if(t){const[e,a]=t;N.value=Number(a)}n++}if(2==w.value){let t=0;for(;t<10&&n<e.length;){let a=e[n].match(/09game (\d+) EXSYGetGameCount: (\d+)\(number\) 09game EXSYGetGameWinCount: (\d+)\(number\)/);if(a){const[e,n,r,s]=a;null!=A(n)&&(v[A(n)].game_count=Number(r),v[A(n)].game_win_count=Number(s),0!=Number(r)&&(v[A(n)].win_rate=Number(s)/Number(r)),t++)}n++}}let r=0;for(;r<10&&n<e.length;){let t=e[n].match(/\[rank\] (\d+), id, (\d+), p：1/);if(t){const[e,a,n]=t;v[A(a)].floor=Number(n),r++}n++}if(-1!=S.value.toLowerCase().indexOf("im")){let t=0;for(;t<10&&n<e.length;){let a=e[n].match(/09game EXSYCallParam2\(10001, (\d+), chenju\) \d+,(.*?)\(string\)/);if(a){const[e,n,r]=a;null!=A(n)&&(v[A(n)].achieve=M(r),t++)}n++}}for(;n<e.length;){let t=e[n].match(/\[rank\] (\d+), 9, (\d+), p：1/);if(t){const[e,a,n]=t;v[A(a)].hero=n}n++}}(e.data.gamelog),G.value=j();for(const t of v){if(0==t.user_id.length)continue;let e=`http://users.09game.com/Home/GetUserAchievement?user_id=${t.user_id}`;k.get("http://127.0.0.1:7733/p/GetUserAchievement",{params:{url:e}}).then((e=>{const a=e.data.data;0==a.result&&(t.achieve_score=a.temp.total_score)})),e=`http://users.09game.com/home/GetUserPub?user_id=${t.user_id}`,k.get("http://127.0.0.1:7733/p/getUserPub",{params:{url:e}}).then((e=>{const a=e.data.data;0==a.result&&(t.user_level=a.temp[0].level,t.user_name=a.temp[0].user_name)}));let a=0;a=-1!=S.value.toLowerCase().indexOf("im")?2:-1!=S.value.toLowerCase().indexOf("omg")?21:1,e=`http://score.09game.com/MOBA/UserRanking?gameTypeId=${a}&UserID=${t.user_id}`,k.get("http://127.0.0.1:7733/p/UserRanking",{params:{url:e}}).then((e=>{const a=e.data.data;0==a.code&&a.data.length>0&&(t.rank=a.data[0].rank_number)})),e=`http://score.09game.com/Ordinary/SeasonSummary?UserID=${t.user_id}&GameTypeID=${a}`,k.get("http://127.0.0.1:7733/p/SeasonSummary",{params:{url:e}}).then((e=>{const a=e.data.data;0==a.code&&a.data.season.length>0&&(t.score=a.data.season[0].score,t.arena_score=a.data.season[0].arena_score),0==t.score&&(t.score=100)}))}}))}function j(){let e=[{title:"玩家名　　",key:"display_name",render:e=>o("div",[o(l,{text:!0,tag:"a",href:`http://www.09game.com/html/2020gamescore/web/?userid=${e.user_id}&type=2`,target:"_blank",style:`color:${z(e)}`},(()=>e.display_name)),o(l,{text:!0,size:"tiny",style:"padding-left:8px",onclick:()=>function(e){const t=document.getElementById("copy_text");t.value=e.user_name,t.select(),document.execCommand("Copy"),E.success(`${e.user_name} 复制成功`,{duration:1e3})}(e)},(()=>"#"))]),className:"name"},{title:"英雄",key:"hero",render:e=>o("img",{src:`http://127.0.0.1:7733/pic?url=http://cdn.09game.com/resources/game_avator/${X(e.hero)}.jpg`,width:"34",height:"34"}),className:"hero"},{title:"等级",key:"user_level",render:e=>2==w.value?[o("span",{},e.user_level<10?`0${e.user_level}`:e.user_level),o("img",{src:`http://127.0.0.1:7733/pic?url=http://www.09game.com/statics/recharge/${e.vip_level}.png`})]:o("span",{},e.user_level)},{title:"胜场",key:"game_win_count"},{title:"局数",key:"game_count"},{title:"胜率",key:"win_rate",render:e=>o("span",{},Math.round(1e4*e.win_rate/100).toFixed(0)+"%")},{title:"排名",key:"rank"},{title:"段位",key:"score",render(e){const t=e.score;if(t>0&&t<1600){const e=o(b,{src:`http://127.0.0.1:7733/pic?url=http://www.09game.com/statics/IMsegment/0/${Math.round(t/100)}.png`,width:"34",height:"34"});let a=o("span",{},(t%100/10).toFixed(1));return t>=700&&(a=o("span",{},(Math.round(t/100)-6+t%100/10).toFixed(1))),[e,a]}return 1600==t?[o(b,{src:"http://127.0.0.1:7733/pic?url=http://www.09game.com/statics/IMsegment/0/16.png",width:"34",height:"34"}),o("span",{},e.arena_score)]:t}}];return 2==w.value&&e.push({title:"成就",key:"achieve",render:e=>o("span",{},`[${e.achieve_score}] ${e.achieve}`)}),e.push({title:"操作",key:"other",render:e=>o("div",[o(l,{size:"tiny",style:"padding:2px",onclick:()=>{return t=e.user_id,void window.open(`http://plai-ml.gitee.io/sb09game/imseason?userid=${t}`,"_blank","alwaysRaised,width=732,height=460,location=no");var t}},(()=>"曲线")),o(l,{size:"tiny",style:"margin-left:2px;padding:2px;",onclick:()=>function(e,t){const a=`http://users.09game.com/home/userrelation?token=${U.state.token}&to_user_id=${e}&user_action=0`;k.get("http://127.0.0.1:7733/p/userrelation",{params:{url:a}}).then((e=>{const a=e.data.data;0==a.code?E.success(`${a.msg} [${t}]`,{duration:2e3}):E.error(a.msg)}))}(e.user_id,e.user_name)},(()=>"关注"))]),className:"other"}),e}function P(e,t){return Array.from(Array(t-e).keys()).map(((t,a)=>a+e))}let U=i();function z(e){return e.slot==I?"blue":e.floor<=5?"green":"red"}function A(e){return{1:0,2:1,3:2,4:3,5:4,7:5,8:6,9:7,10:8,11:9}[e]}const L=(e,t)=>e.slot==I?"me":e.floor<=5?"jinwei":"tianzai";function M(e){const t={A:["攻击",1],B:["攻速",0],C:["移速",0],D:["力量",0],E:["敏捷",0],F:["智力",0],G:["血量",1],H:["蓝量",1],I:["金钱",0],J:["经验",1],K:["回血",0],L:["回蓝",0],M:["护甲",0],N:["魔抗",1],O:["法术吸血",1],P:["物理吸血",1]};let a=[];for(const n of e.split(";")){if(0==n.length)continue;let[e,r]=n.split("=");const s=t[e][0],o=t[e][1];0==o&&a.push(`${s}+${Number(r)/100}`),1==o&&a.push(`${s}+${r}%`)}return a.join(",")}function X(e){const t=Number(e);if(t<=0)return"0";var a=String.fromCharCode(255&t),n=String.fromCharCode(t>>8&255),r=String.fromCharCode(t>>16&255);return String.fromCharCode(t>>24&255)+r+n+a}const Y={DataTable:{thPaddingSmall:"8px 0px 8px 2px",tdPaddingSmall:"0px 5px 0px 0px",lineHeight:"1"}};return(e,t)=>(c(),u(d(g),{vertical:"",justify:"center"},{default:x((()=>[m(d(g),{justify:"center",id:"table-space"},{default:x((()=>[m(d(p),{"theme-overrides":Y},{default:x((()=>[m(d(h),{size:"small",columns:G.value,data:d(y),"single-line":!1,"row-class-name":L},null,8,["columns","data"])])),_:1})])),_:1}),m(d(g),{vertical:"",justify:"center"},{default:x((()=>[m(d(l),{onClick:O,size:"large",style:{width:"700px"}},{default:x((()=>[$])),_:1}),m("p",null,"game source "+f(N.value),1),m("p",null,"map "+f(S.value),1),C])),_:1})])),_:1}))}});N.__scopeId="data-v-5e88e7e3";export{N as default};
