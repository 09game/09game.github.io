import{d as e,q as t,p as a,s as r,m as n,n as s,y as o,o as l,c as i,a as c,u,B as m,z as d,A as h,x as p,t as g,C as f,D as _,g as v,E as w,v as y,G as x}from"./vendor.ad827fc2.js";import{a as b}from"./index.edf0dc5a.js";const k=f("data-v-2f46aa77");_("data-v-2f46aa77");const C=v("<"),$=v(">"),S=c("input",{id:"copy_text",style:{opacity:"0",position:"absolute"}},null,-1);w();var N=e({setup(e){t((()=>{!function(){const e="http://127.0.0.1:7733/get-token-by-2009";b.get(e).then((e=>{M.commit("setToken",e.data.token)}))}(),v()}));const f=a(0),_=r();function v(){b.get("http://127.0.0.1:7733/t/get-gamelog",{params:{index:f.value}}).then((e=>{!function(e){O.length=0,G.value=e[1];const t=E(4,9).concat(E(10,15));for(let s=0;s<t.length;s++){const a=e[t[s]].match(/玩家\[(\d+)\]\[(.*)\]/);if(a){const[e,t,r]=a,n=Number(t)-1;O.push({user_name:"",achieve_score:0,display_name:r,other:"",score:0,arena_score:0,user_level:0,achieve:"",user_id:"",vip_level:0,slot:n,win_rate:"",game_win_count:0,game_count:0,rank:0,floor:0,hero:""})}}let a=e[19].match(/本地玩家\[(\d+)\]\[(.*)\]/);if(a){const[e,t,r]=a;j=Number(t)-1}let r=20;if(-1!=G.value.toLowerCase().indexOf("omg")){let t=0;for(;t<10&&r<e.length;){let a=e[r].match(/09game EXSYGetGameCount, (\d+),(\d+)\(number\)/);if(a){const[e,r,n]=a;O[U(r)].game_count=Number(n),t++}r++}}if(-1!=G.value.toLowerCase().indexOf("im")){const t=E(22,27).concat(E(28,33));for(let a=0;a<t.length;a++){const r=e[t[a]].match(/09game EXSYGetPlayerId, (\d+),(\d+)\(number\)/);if(r){const[e,t,a]=r,n=Number(t);O.filter((e=>e.slot==n))[0].user_id=a}}}if(-1!=G.value.toLowerCase().indexOf("im")){let t=0;for(;t<10&&r<e.length;){let a=e[r].match(/09game EXSYGetVIPLevel, (\d+),(\d+)\(number\)/);if(a){const[e,r,n]=a;null!=U(r)&&(O[U(r)].vip_level=Number(n),t++)}r++}}for(;-1==N.value&&r<e.length;){let t=e[r].match(/09game EXSYGetGameSource, (\d+)\(number\)/);if(t){const[e,a]=t;N.value=Number(a)}r++}if(-1!=G.value.toLowerCase().indexOf("im")){let t=0;for(;t<10&&r<e.length;){let a=e[r].match(/09game (\d+) EXSYGetGameCount: (\d+)\(number\) 09game EXSYGetGameWinCount: (\d+)\(number\)/);if(a){const[e,r,n,s]=a;null!=U(r)&&(O[U(r)].game_count=Number(n),O[U(r)].game_win_count=Number(s),O[U(r)].win_rate=(Math.round(Number(s)/Number(n)*1e4)/100).toFixed(0)+"%",0==O[U(r)].game_count&&(O[U(r)].win_rate="0%"),t++)}r++}}let n=0;for(;n<10&&r<e.length;){let t=e[r].match(/\[rank\] (\d+), id, (\d+), p：1/);if(t){const[e,a,r]=t;O[U(a)].floor=Number(r),n++}r++}if(-1!=G.value.toLowerCase().indexOf("im")){let t=0;for(;t<10&&r<e.length;){let a=e[r].match(/09game EXSYCallParam2\(10001, (\d+), chenju\) \d+,(.*?)\(string\)/);if(a){const[e,r,n]=a;null!=U(r)&&(O[U(r)].achieve=X(n),t++)}r++}}for(;r<e.length;){let t=e[r].match(/\[rank\] (\d+), 9, (\d+), p：1/);if(t){const[e,a,r]=t;O[U(a)].hero=r}r++}}(e.data.gamelog),I.value=w();for(const t of O){if(0==t.user_id.length)continue;let e=`http://users.09game.com/Home/GetUserAchievement?user_id=${t.user_id}`;b.get("http://127.0.0.1:7733/p/GetUserAchievement",{params:{url:e}}).then((e=>{const a=e.data.data;0==a.result&&(t.achieve_score=a.temp.total_score)})),e=`http://users.09game.com/home/GetUserPub?user_id=${t.user_id}`,b.get("http://127.0.0.1:7733/p/getUserPub",{params:{url:e}}).then((e=>{const a=e.data.data;0==a.result&&(t.user_level=a.temp[0].level,t.user_name=a.temp[0].user_name)}));let a=0;a=-1!=G.value.toLowerCase().indexOf("im")?2:-1!=G.value.toLowerCase().indexOf("omg")?21:1,e=`http://score.09game.com/MOBA/UserRanking?gameTypeId=${a}&UserID=${t.user_id}`,b.get("http://127.0.0.1:7733/p/UserRanking",{params:{url:e}}).then((e=>{const a=e.data.data;0==a.code&&a.data.length>0&&(t.rank=a.data[0].rank_number)})),e=`http://score.09game.com/Ordinary/SeasonSummary?UserID=${t.user_id}&GameTypeID=${a}`,b.get("http://127.0.0.1:7733/p/SeasonSummary",{params:{url:e}}).then((e=>{const a=e.data.data;0==a.code&&a.data.season.length>0&&(t.score=a.data.season[0].score,t.arena_score=a.data.season[0].arena_score),0==t.score&&(t.score=100)}))}}))}const w=()=>{let e=[{title:"玩家名　　",key:"display_name",render:e=>y("div",[y(p,{text:!0,tag:"a",href:`http://www.09game.com/html/2020gamescore/web/?userid=${e.user_id}&type=2`,target:"_blank",style:`color:${P(e)}`},{default:()=>e.display_name}),y(p,{text:!0,size:"tiny",style:"padding-left:8px",onclick:()=>{const t=document.getElementById("copy_text");t.value=e.user_name,t.select(),document.execCommand("Copy"),_.success(`${e.user_name} 复制成功`,{duration:1e3})}},(()=>"#"))]),className:"name"},{title:"英雄",key:"hero",render:e=>y("img",{src:`http://127.0.0.1:7733/pic?url=http://cdn.09game.com/resources/game_avator/${Y(e.hero)}.jpg`,width:"34",height:"34"}),className:"hero"},{title:"等级",key:"user_level",render:e=>-1!=G.value.toLowerCase().indexOf("im")?[y("span",{},e.user_level<10?`0${e.user_level}`:e.user_level),y("img",{src:`http://127.0.0.1:7733/pic?url=http://www.09game.com/statics/recharge/${e.vip_level}.png`})]:y("span",{},e.user_level)},{title:"胜场",key:"game_win_count"},{title:"局数",key:"game_count"},{title:"胜率",key:"win_rate"},{title:"排名",key:"rank"},{title:"段位",key:"score",render(e){const t=e.score;return t>0&&t<1600?y("div",t>=700?[y(x,{src:`http://127.0.0.1:7733/pic?url=http://www.09game.com/statics/IMsegment/0/${Math.round(t/100)}.png`,width:"34",height:"34"}),y("span",{},(Math.round(t/100)-6+t%100/10).toFixed(1))]:[y(x,{src:`http://127.0.0.1:7733/pic?url=http://www.09game.com/statics/IMsegment/0/${Math.round(t/100)}.png`,width:"34",height:"34"}),y("span",{},(t%100/10).toFixed(1))]):1600==t?y("div",[y(x,{src:"http://127.0.0.1:7733/pic?url=http://www.09game.com/statics/IMsegment/0/16.png",width:"34",height:"34"}),y("span",{},e.arena_score)]):t}}];return-1!=G.value.toLowerCase().indexOf("im")&&e.push({title:"成就",key:"achieve",render:e=>y("span",{},`[${e.achieve_score}] ${e.achieve}`)}),e.push({title:"操作",key:"other",render:e=>y("div",[y(p,{size:"tiny",style:"padding:2px",onclick:()=>{return t=e.user_id,void window.open(`http://plai-ml.gitee.io/sb09game/imseason?userid=${t}`,"_blank","alwaysRaised,width=732,height=460,location=no");var t}},(()=>"曲线")),y(p,{size:"tiny",style:"margin-left:2px;padding:2px;",onclick:()=>function(e,t){const a=`http://users.09game.com/home/userrelation?token=${M.state.token}&to_user_id=${e}&user_action=0`;b.get("http://127.0.0.1:7733/p/userrelation",{params:{url:a}}).then((e=>{const a=e.data.data;0==a.code?_.success(`${a.msg} [${t}]`,{duration:2e3}):_.error(a.msg)}))}(e.user_id,e.user_name)},(()=>"关注"))]),className:"other"}),e},N=a(-1),G=a(""),I=a(w()),O=n([{user_name:"",achieve_score:0,display_name:"",score:0,arena_score:0,other:"",user_level:0,achieve:"",vip_level:0,user_id:"",slot:0,win_rate:"",game_win_count:0,game_count:0,rank:0,floor:0,hero:""}]);O.length=0;const L=s((()=>O.sort(((e,t)=>e.floor-t.floor))));let j=0;function E(e,t){return Array.from(Array(t-e).keys()).map(((t,a)=>a+e))}let M=o();function P(e){return e.slot==j?"blue":e.floor<=5?"green":"red"}function U(e){return{1:0,2:1,3:2,4:3,5:4,7:5,8:6,9:7,10:8,11:9}[e]}const A=(e,t)=>e.slot==j?"me":e.floor<=5?"jinwei":"tianzai";function X(e){const t={A:["攻击",1],B:["攻速",0],C:["移速",0],D:["力量",0],E:["敏捷",0],F:["智力",0],G:["血量",1],H:["蓝量",1],I:["金钱",0],J:["经验",1],K:["回血",0],L:["回蓝",0],M:["护甲",0],N:["魔抗",1],O:["法术吸血",1],P:["物理吸血",1]};let a=[];for(const r of e.split(";")){if(0==r.length)continue;let[e,n]=r.split("=");const s=t[e][0],o=t[e][1];0==o&&a.push(`${s}+${Number(n)/100}`),1==o&&a.push(`${s}+${n}%`)}return a.join(",")}function Y(e){const t=Number(e);if(t<=0)return"0";var a=String.fromCharCode(255&t),r=String.fromCharCode(t>>8&255),n=String.fromCharCode(t>>16&255);return String.fromCharCode(t>>24&255)+n+r+a}const z={DataTable:{thPaddingSmall:"8px 0px 8px 2px",tdPaddingSmall:"0px 5px 0px 0px",lineHeight:"1"}};return(e,t)=>(l(),i(u(m),{vertical:"",justify:"center"},{default:k((()=>[c(u(m),{justify:"center",id:"table-space"},{default:k((()=>[c(u(d),{"theme-overrides":z},{default:k((()=>[c(u(h),{size:"small",columns:I.value,data:u(L),"single-line":!1,"row-class-name":A},null,8,["columns","data"])])),_:1})])),_:1}),c(u(m),{vertical:"",justify:"center"},{default:k((()=>[c(u(m),{justify:"center"},{default:k((()=>[c(u(p),{onClick:t[1]||(t[1]=e=>{f.value++,v()}),style:{width:"300px"}},{default:k((()=>[C])),_:1}),c(u(p),{onClick:t[2]||(t[2]=e=>{f.value--,v()}),style:{width:"300px"},disabled:0==f.value},{default:k((()=>[$])),_:1},8,["disabled"])])),_:1}),c("p",null,"game source "+g(N.value),1),c("p",null,"map "+g(G.value),1),S])),_:1})])),_:1}))}});N.__scopeId="data-v-2f46aa77";export{N as default};
