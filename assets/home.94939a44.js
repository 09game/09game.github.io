import{d as e,p as t,q as a,s as r,v as n,x as s,y as o,z as l,A as i,B as u,o as c,c as m,w as d,a as p,u as h,C as g,D as f,E as _,b as v,t as y,i as w,G as b,H as x}from"./vendor.ac815328.js";import{a as k}from"./index.2885cb15.js";import{_ as $}from"./plugin-vue_export-helper.5a098b48.js";const C=e=>(b("data-v-5e88e7e3"),e=e(),x(),e),N=w("刷新"),S=C((()=>v("input",{id:"copy_text",style:{opacity:"0",position:"absolute"}},null,-1)));var G=$(e({setup(e){const w={user_name:"",display_name:"",user_id:"",score:0,arena_score:0,other:"",user_level:0,achieve:"",achieve_score:0,vip_level:0,slot:0,win_rate:0,game_win_count:0,game_count:0,rank:0,floor:0,hero:""},b=t([w]);b.length=0;const x=a((()=>b.sort(((e,t)=>e.floor-t.floor)))),$=a((()=>-1!=G.value.toLowerCase().indexOf("im")?2:-1!=G.value.toLowerCase().indexOf("omg")?21:1)),C=r(-1),G=r(""),I=r(P());let j=0;n((()=>{!function(){const e="http://127.0.0.1:7733/get-token-by-2009";k.get(e).then((e=>{z.commit("setToken",e.data.token)}))}(),O()}));const E=s();function O(){k.get("http://127.0.0.1:7733/t/get-gamelog",{params:{index:0}}).then((e=>{!function(e){b.length=0,G.value=e[1];const t=U(4,9).concat(U(10,15));for(let s=0;s<t.length;s++){const a=e[t[s]].match(/玩家\[(\d+)\]\[(.*)\]/);if(a){const[e,t,r]=a,n=Number(t)-1;let s=JSON.parse(JSON.stringify(w));s.display_name=r,s.slot=n,b.push(s)}}console.log(b);let a=e[19].match(/本地玩家\[(\d+)\]\[(.*)\]/);if(a){const[e,t,r]=a;j=Number(t)-1}let r=20;if(21==$.value){let t=0;for(;t<10&&r<e.length;){let a=e[r].match(/09game EXSYGetGameCount, (\d+),(\d+)\(number\)/);if(a){const[e,r,n]=a;b[L(r)].game_count=Number(n),t++}r++}}if(2==$.value){const t=U(22,27).concat(U(28,33));for(let a=0;a<t.length;a++){const r=e[t[a]].match(/09game EXSYGetPlayerId, (\d+),(\d+)\(number\)/);if(r){const[e,t,a]=r,n=Number(t);b.filter((e=>e.slot==n))[0].user_id=a}}}if(2==$.value){let t=0;for(;t<10&&r<e.length;){let a=e[r].match(/09game EXSYGetVIPLevel, (\d+),(\d+)\(number\)/);if(a){const[e,r,n]=a;null!=L(r)&&(b[L(r)].vip_level=Number(n),t++)}r++}}for(;-1==C.value&&r<e.length;){let t=e[r].match(/09game EXSYGetGameSource, (\d+)\(number\)/);if(t){const[e,a]=t;C.value=Number(a)}r++}if(2==$.value){let t=0;for(;t<10&&r<e.length;){let a=e[r].match(/09game (\d+) EXSYGetGameCount: (\d+)\(number\) 09game EXSYGetGameWinCount: (\d+)\(number\)/);if(a){const[e,r,n,s]=a;null!=L(r)&&(b[L(r)].game_count=Number(n),b[L(r)].game_win_count=Number(s),0!=Number(n)&&(b[L(r)].win_rate=Number(s)/Number(n)),t++)}r++}}let n=0;for(;n<10&&r<e.length;){let t=e[r].match(/\[rank\] (\d+), id, (\d+), p：1/);if(t){const[e,a,r]=t;b[L(a)].floor=Number(r),n++}r++}if(-1!=G.value.toLowerCase().indexOf("im")){let t=0;for(;t<10&&r<e.length;){let a=e[r].match(/09game EXSYCallParam2\(10001, (\d+), chenju\) \d+,(.*?)\(string\)/);if(a){const[e,r,n]=a;null!=L(r)&&(b[L(r)].achieve=X(n),t++)}r++}}for(;r<e.length;){let t=e[r].match(/\[rank\] (\d+), 9, (\d+), p：1/);if(t){const[e,a,r]=t;b[L(a)].hero=r}r++}}(e.data.gamelog),I.value=P();for(const t of b){if(0==t.user_id.length)continue;let e=`http://users.09game.com/Home/GetUserAchievement?user_id=${t.user_id}`;k.get("http://127.0.0.1:7733/p/GetUserAchievement",{params:{url:e}}).then((e=>{const a=e.data.data;0==a.result&&(t.achieve_score=a.temp.total_score)})),e=`http://users.09game.com/home/GetUserPub?user_id=${t.user_id}`,k.get("http://127.0.0.1:7733/p/getUserPub",{params:{url:e}}).then((e=>{const a=e.data.data;0==a.result&&(t.user_level=a.temp[0].level,t.user_name=a.temp[0].user_name)}));let a=0;a=-1!=G.value.toLowerCase().indexOf("im")?2:-1!=G.value.toLowerCase().indexOf("omg")?21:1,e=`http://score.09game.com/MOBA/UserRanking?gameTypeId=${a}&UserID=${t.user_id}`,k.get("http://127.0.0.1:7733/p/UserRanking",{params:{url:e}}).then((e=>{const a=e.data.data;0==a.code&&a.data.length>0&&(t.rank=a.data[0].rank_number)})),e=`http://score.09game.com/Ordinary/SeasonSummary?UserID=${t.user_id}&GameTypeID=${a}`,k.get("http://127.0.0.1:7733/p/SeasonSummary",{params:{url:e}}).then((e=>{const a=e.data.data;0==a.code&&a.data.season.length>0&&(t.score=a.data.season[0].score,t.arena_score=a.data.season[0].arena_score),0==t.score&&(t.score=100)}))}}))}function P(){let e=[{title:"玩家名　　",key:"display_name",render:e=>o("div",[o(l,{text:!0,tag:"a",href:`http://www.09game.com/html/2020gamescore/web/?userid=${e.user_id}&type=2`,target:"_blank",style:`color:${A(e)}`},(()=>e.display_name)),o(l,{text:!0,size:"tiny",style:"padding-left:8px",onclick:()=>function(e){const t=document.getElementById("copy_text");t.value=e.user_name,t.select(),document.execCommand("Copy"),E.success(`${e.user_name} 复制成功`,{duration:1e3})}(e)},(()=>"#"))]),className:"name"},{title:"英雄",key:"hero",render:e=>o("img",{src:`http://127.0.0.1:7733/pic?url=http://cdn.09game.com/resources/game_avator/${Y(e.hero)}.jpg`,width:"34",height:"34"}),className:"hero"},{title:"等级",key:"user_level",render:e=>2==$.value?[o("span",{},e.user_level<10?`0${e.user_level}`:e.user_level),o("img",{src:`http://127.0.0.1:7733/pic?url=http://www.09game.com/statics/recharge/${e.vip_level}.png`})]:o("span",{},e.user_level)},{title:"胜场",key:"game_win_count"},{title:"局数",key:"game_count"},{title:"胜率",key:"win_rate",render:e=>o("span",{},Math.round(1e4*e.win_rate/100).toFixed(0)+"%")},{title:"排名",key:"rank"},{title:"段位",key:"score",render(e){const t=e.score;if(t>0&&t<1600){const e=o(i,{src:`http://127.0.0.1:7733/pic?url=http://www.09game.com/statics/IMsegment/0/${Math.round(t/100)}.png`,width:"34",height:"34"});let a=o("span",{},(t%100/10).toFixed(1));return t>=700&&(a=o("span",{},(Math.round(t/100)-6+t%100/10).toFixed(1))),[e,a]}return 1600==t?[o(i,{src:"http://127.0.0.1:7733/pic?url=http://www.09game.com/statics/IMsegment/0/16.png",width:"34",height:"34"}),o("span",{},e.arena_score)]:t}}];return 2==$.value&&e.push({title:"成就",key:"achieve",render:e=>o("span",{},`[${e.achieve_score}] ${e.achieve}`)}),e.push({title:"操作",key:"other",render:e=>o("div",[o(l,{size:"tiny",style:"padding:2px",onclick:()=>{return t=e.user_id,void window.open(`http://plai-ml.gitee.io/sb09game/imseason?userid=${t}`,"_blank","alwaysRaised,width=732,height=460,location=no");var t}},(()=>"曲线")),o(l,{size:"tiny",style:"margin-left:2px;padding:2px;",onclick:()=>function(e,t){const a=`http://users.09game.com/home/userrelation?token=${z.state.token}&to_user_id=${e}&user_action=0`;k.get("http://127.0.0.1:7733/p/userrelation",{params:{url:a}}).then((e=>{const a=e.data.data;0==a.code?E.success(`${a.msg} [${t}]`,{duration:2e3}):E.error(a.msg)}))}(e.user_id,e.user_name)},(()=>"关注"))]),className:"other"}),e}function U(e,t){return Array.from(Array(t-e).keys()).map(((t,a)=>a+e))}let z=u();function A(e){return e.slot==j?"blue":e.floor<=5?"green":"red"}function L(e){return{1:0,2:1,3:2,4:3,5:4,7:5,8:6,9:7,10:8,11:9}[e]}const M=(e,t)=>e.slot==j?"me":e.floor<=5?"jinwei":"tianzai";function X(e){const t={A:["攻击",1],B:["攻速",0],C:["移速",0],D:["力量",0],E:["敏捷",0],F:["智力",0],G:["血量",1],H:["蓝量",1],I:["金钱",0],J:["经验",1],K:["回血",0],L:["回蓝",0],M:["护甲",0],N:["魔抗",1],O:["法术吸血",1],P:["物理吸血",1]};let a=[];for(const r of e.split(";")){if(0==r.length)continue;let[e,n]=r.split("=");const s=t[e][0],o=t[e][1];0==o&&a.push(`${s}+${Number(n)/100}`),1==o&&a.push(`${s}+${n}%`)}return a.join(",")}function Y(e){const t=Number(e);if(t<=0)return"0";var a=String.fromCharCode(255&t),r=String.fromCharCode(t>>8&255),n=String.fromCharCode(t>>16&255);return String.fromCharCode(t>>24&255)+n+r+a}const D={DataTable:{thPaddingSmall:"8px 0px 8px 2px",tdPaddingSmall:"0px 5px 0px 0px",lineHeight:"1"}};return(e,t)=>(c(),m(h(_),{vertical:"",justify:"center"},{default:d((()=>[p(h(_),{justify:"center",id:"table-space"},{default:d((()=>[p(h(g),{"theme-overrides":D},{default:d((()=>[p(h(f),{size:"small",columns:I.value,data:h(x),"single-line":!1,"row-class-name":M},null,8,["columns","data"])])),_:1})])),_:1}),p(h(_),{vertical:"",justify:"center"},{default:d((()=>[p(h(l),{onClick:O,size:"large",style:{width:"700px"}},{default:d((()=>[N])),_:1}),v("p",null,"game source "+y(C.value),1),v("p",null,"map "+y(G.value),1),S])),_:1})])),_:1}))}}),[["__scopeId","data-v-5e88e7e3"]]);export{G as default};
