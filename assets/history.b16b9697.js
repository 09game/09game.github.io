import{d as e,v as t,s as a,x as r,p as n,q as s,B as o,o as i,c as l,w as c,u,y as m,z as d,A as h,a as p,E as g,D as _,C as f,b as v,t as w,i as y,G as b,H as x}from"./vendor.ac815328.js";import{a as k}from"./index.2885cb15.js";import{_ as C}from"./plugin-vue_export-helper.5a098b48.js";const $=e=>(b("data-v-70c522ca"),e=e(),x(),e),S=y("<"),N=y(">"),G=$((()=>v("input",{id:"copy_text",style:{opacity:"0",position:"absolute"}},null,-1)));var I=C(e({setup(e){t((()=>{!function(){const e="http://127.0.0.1:7733/get-token-by-2009";k.get(e).then((e=>{P.commit("setToken",e.data.token)}))}(),x()}));const y=a(0),b=r();function x(){k.get("http://127.0.0.1:7733/t/get-gamelog",{params:{index:y.value}}).then((e=>{!function(e){j.length=0,I.value=e[1];const t=M(4,9).concat(M(10,15));for(let s=0;s<t.length;s++){const a=e[t[s]].match(/玩家\[(\d+)\]\[(.*)\]/);if(a){const[e,t,r]=a,n=Number(t)-1;j.push({user_name:"",achieve_score:0,display_name:r,other:"",score:0,arena_score:0,user_level:0,achieve:"",user_id:"",vip_level:0,slot:n,win_rate:"",game_win_count:0,game_count:0,rank:0,floor:0,hero:""})}}let a=e[19].match(/本地玩家\[(\d+)\]\[(.*)\]/);if(a){const[e,t,r]=a;E=Number(t)-1}let r=20;if(-1!=I.value.toLowerCase().indexOf("omg")){let t=0;for(;t<10&&r<e.length;){let a=e[r].match(/09game EXSYGetGameCount, (\d+),(\d+)\(number\)/);if(a){const[e,r,n]=a;j[A(r)].game_count=Number(n),t++}r++}}if(-1!=I.value.toLowerCase().indexOf("im")){const t=M(22,27).concat(M(28,33));for(let a=0;a<t.length;a++){const r=e[t[a]].match(/09game EXSYGetPlayerId, (\d+),(\d+)\(number\)/);if(r){const[e,t,a]=r,n=Number(t);j.filter((e=>e.slot==n))[0].user_id=a}}}if(-1!=I.value.toLowerCase().indexOf("im")){let t=0;for(;t<10&&r<e.length;){let a=e[r].match(/09game EXSYGetVIPLevel, (\d+),(\d+)\(number\)/);if(a){const[e,r,n]=a;null!=A(r)&&(j[A(r)].vip_level=Number(n),t++)}r++}}for(;-1==$.value&&r<e.length;){let t=e[r].match(/09game EXSYGetGameSource, (\d+)\(number\)/);if(t){const[e,a]=t;$.value=Number(a)}r++}if(-1!=I.value.toLowerCase().indexOf("im")){let t=0;for(;t<10&&r<e.length;){let a=e[r].match(/09game (\d+) EXSYGetGameCount: (\d+)\(number\) 09game EXSYGetGameWinCount: (\d+)\(number\)/);if(a){const[e,r,n,s]=a;null!=A(r)&&(j[A(r)].game_count=Number(n),j[A(r)].game_win_count=Number(s),j[A(r)].win_rate=(Math.round(Number(s)/Number(n)*1e4)/100).toFixed(0)+"%",0==j[A(r)].game_count&&(j[A(r)].win_rate="0%"),t++)}r++}}let n=0;for(;n<10&&r<e.length;){let t=e[r].match(/\[rank\] (\d+), id, (\d+), p：1/);if(t){const[e,a,r]=t;j[A(a)].floor=Number(r),n++}r++}if(-1!=I.value.toLowerCase().indexOf("im")){let t=0;for(;t<10&&r<e.length;){let a=e[r].match(/09game EXSYCallParam2\(10001, (\d+), chenju\) \d+,(.*?)\(string\)/);if(a){const[e,r,n]=a;null!=A(r)&&(j[A(r)].achieve=Y(n),t++)}r++}}for(;r<e.length;){let t=e[r].match(/\[rank\] (\d+), 9, (\d+), p：1/);if(t){const[e,a,r]=t;j[A(a)].hero=r}r++}}(e.data.gamelog),O.value=C();for(const t of j){if(0==t.user_id.length)continue;let e=`http://users.09game.com/Home/GetUserAchievement?user_id=${t.user_id}`;k.get("http://127.0.0.1:7733/p/GetUserAchievement",{params:{url:e}}).then((e=>{const a=e.data.data;0==a.result&&(t.achieve_score=a.temp.total_score)})),e=`http://users.09game.com/home/GetUserPub?user_id=${t.user_id}`,k.get("http://127.0.0.1:7733/p/getUserPub",{params:{url:e}}).then((e=>{const a=e.data.data;0==a.result&&(t.user_level=a.temp[0].level,t.user_name=a.temp[0].user_name)}));let a=0;a=-1!=I.value.toLowerCase().indexOf("im")?2:-1!=I.value.toLowerCase().indexOf("omg")?21:1,e=`http://score.09game.com/MOBA/UserRanking?gameTypeId=${a}&UserID=${t.user_id}`,k.get("http://127.0.0.1:7733/p/UserRanking",{params:{url:e}}).then((e=>{const a=e.data.data;0==a.code&&a.data.length>0&&(t.rank=a.data[0].rank_number)})),e=`http://score.09game.com/Ordinary/SeasonSummary?UserID=${t.user_id}&GameTypeID=${a}`,k.get("http://127.0.0.1:7733/p/SeasonSummary",{params:{url:e}}).then((e=>{const a=e.data.data;0==a.code&&a.data.season.length>0&&(t.score=a.data.season[0].score,t.arena_score=a.data.season[0].arena_score),0==t.score&&(t.score=100)}))}}))}const C=()=>{let e=[{title:"玩家名　　",key:"display_name",render:e=>m("div",[m(d,{text:!0,tag:"a",href:`http://www.09game.com/html/2020gamescore/web/?userid=${e.user_id}&type=2`,target:"_blank",style:`color:${U(e)}`},{default:()=>e.display_name}),m(d,{text:!0,size:"tiny",style:"padding-left:8px",onclick:()=>{const t=document.getElementById("copy_text");t.value=e.user_name,t.select(),document.execCommand("Copy"),b.success(`${e.user_name} 复制成功`,{duration:1e3})}},(()=>"#"))]),className:"name"},{title:"英雄",key:"hero",render:e=>m("img",{src:`http://127.0.0.1:7733/pic?url=http://cdn.09game.com/resources/game_avator/${z(e.hero)}.jpg`,width:"34",height:"34"}),className:"hero"},{title:"等级",key:"user_level",render:e=>-1!=I.value.toLowerCase().indexOf("im")?[m("span",{},e.user_level<10?`0${e.user_level}`:e.user_level),m("img",{src:`http://127.0.0.1:7733/pic?url=http://www.09game.com/statics/recharge/${e.vip_level}.png`})]:m("span",{},e.user_level)},{title:"胜场",key:"game_win_count"},{title:"局数",key:"game_count"},{title:"胜率",key:"win_rate"},{title:"排名",key:"rank"},{title:"段位",key:"score",render(e){const t=e.score;return t>0&&t<1600?m("div",t>=700?[m(h,{src:`http://127.0.0.1:7733/pic?url=http://www.09game.com/statics/IMsegment/0/${Math.round(t/100)}.png`,width:"34",height:"34"}),m("span",{},(Math.round(t/100)-6+t%100/10).toFixed(1))]:[m(h,{src:`http://127.0.0.1:7733/pic?url=http://www.09game.com/statics/IMsegment/0/${Math.round(t/100)}.png`,width:"34",height:"34"}),m("span",{},(t%100/10).toFixed(1))]):1600==t?m("div",[m(h,{src:"http://127.0.0.1:7733/pic?url=http://www.09game.com/statics/IMsegment/0/16.png",width:"34",height:"34"}),m("span",{},e.arena_score)]):t}}];return-1!=I.value.toLowerCase().indexOf("im")&&e.push({title:"成就",key:"achieve",render:e=>m("span",{},`[${e.achieve_score}] ${e.achieve}`)}),e.push({title:"操作",key:"other",render:e=>m("div",[m(d,{size:"tiny",style:"padding:2px",onclick:()=>{return t=e.user_id,void window.open(`http://iplai.gitee.io/sb09game/imseason?userid=${t}`,"_blank","alwaysRaised,width=732,height=460,location=no");var t}},(()=>"曲线")),m(d,{size:"tiny",style:"margin-left:2px;padding:2px;",onclick:()=>function(e,t){const a=`http://users.09game.com/home/userrelation?token=${P.state.token}&to_user_id=${e}&user_action=0`;k.get("http://127.0.0.1:7733/p/userrelation",{params:{url:a}}).then((e=>{const a=e.data.data;0==a.code?b.success(`${a.msg} [${t}]`,{duration:2e3}):b.error(a.msg)}))}(e.user_id,e.user_name)},(()=>"关注"))]),className:"other"}),e},$=a(-1),I=a(""),O=a(C()),j=n([{user_name:"",achieve_score:0,display_name:"",score:0,arena_score:0,other:"",user_level:0,achieve:"",vip_level:0,user_id:"",slot:0,win_rate:"",game_win_count:0,game_count:0,rank:0,floor:0,hero:""}]);j.length=0;const L=s((()=>j.sort(((e,t)=>e.floor-t.floor))));let E=0;function M(e,t){return Array.from(Array(t-e).keys()).map(((t,a)=>a+e))}let P=o();function U(e){return e.slot==E?"blue":e.floor<=5?"green":"red"}function A(e){return{1:0,2:1,3:2,4:3,5:4,7:5,8:6,9:7,10:8,11:9}[e]}const X=(e,t)=>e.slot==E?"me":e.floor<=5?"jinwei":"tianzai";function Y(e){const t={A:["攻击",1],B:["攻速",0],C:["移速",0],D:["力量",0],E:["敏捷",0],F:["智力",0],G:["血量",1],H:["蓝量",1],I:["金钱",0],J:["经验",1],K:["回血",0],L:["回蓝",0],M:["护甲",0],N:["魔抗",1],O:["法术吸血",1],P:["物理吸血",1]};let a=[];for(const r of e.split(";")){if(0==r.length)continue;let[e,n]=r.split("=");const s=t[e][0],o=t[e][1];0==o&&a.push(`${s}+${Number(n)/100}`),1==o&&a.push(`${s}+${n}%`)}return a.join(",")}function z(e){const t=Number(e);if(t<=0)return"0";var a=String.fromCharCode(255&t),r=String.fromCharCode(t>>8&255),n=String.fromCharCode(t>>16&255);return String.fromCharCode(t>>24&255)+n+r+a}const D={DataTable:{thPaddingSmall:"8px 0px 8px 2px",tdPaddingSmall:"0px 5px 0px 0px",lineHeight:"1"}};return(e,t)=>(i(),l(u(g),{vertical:"",justify:"center"},{default:c((()=>[p(u(g),{id:"table-space",justify:"center"},{default:c((()=>[p(u(f),{"theme-overrides":D},{default:c((()=>[p(u(_),{size:"small",columns:O.value,data:u(L),"single-line":!1,"row-class-name":X},null,8,["columns","data"])])),_:1})])),_:1}),p(u(g),{vertical:"",justify:"center"},{default:c((()=>[p(u(g),{justify:"center"},{default:c((()=>[p(u(d),{onClick:t[0]||(t[0]=e=>{y.value++,x()}),style:{width:"300px"}},{default:c((()=>[S])),_:1}),p(u(d),{onClick:t[1]||(t[1]=e=>{y.value--,x()}),style:{width:"300px"},disabled:0==y.value},{default:c((()=>[N])),_:1},8,["disabled"])])),_:1}),v("p",null,"game source "+w($.value),1),v("p",null,"map "+w(I.value),1),G])),_:1})])),_:1}))}}),[["__scopeId","data-v-70c522ca"]]);export{I as default};
